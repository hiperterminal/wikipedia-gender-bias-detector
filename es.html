<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detector de Sesgo de G√©nero ‚Äî Biograf√≠as de Mujeres en Wikipedia</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,800;1,400;1,700&family=Source+Serif+4:ital,wght@0,300;0,400;0,600;1,300;1,400&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body { font-family: 'Source Serif 4', Georgia, serif; background: #FAF8F5; color: #0A0A0A; -webkit-font-smoothing: antialiased; }
    @keyframes fadeUp { from { opacity:0; transform:translateY(14px); } to { opacity:1; transform:translateY(0); } }
    @keyframes spin   { from { transform:rotate(0deg); } to { transform:rotate(360deg); } }
    input:focus { outline:none; border-color:#E3120B !important; box-shadow:0 0 0 3px rgba(227,18,11,0.1); }
    a:hover { opacity:.8; }
    button:hover:not(:disabled) { opacity:.88; }
    button:disabled { cursor:not-allowed; }
    .report-anim { animation: fadeUp .4s ease both; }
    .inst-row { transition: background .12s; }
    .inst-row:hover { background: #fafafa; }
    kbd { padding:1px 5px; background:#f0f0f0; border:1px solid #ccc; border-radius:3px; font-size:11px; font-family:'IBM Plex Mono',monospace; }
    .dropdown-wrap { position:relative; flex:1; min-width:220px; }
    .dropdown-list { position:absolute; top:calc(100% + 3px); left:0; right:0; z-index:100; background:#fff; border:1.5px solid #E3120B; border-radius:3px; max-height:260px; overflow-y:auto; box-shadow:0 6px 24px rgba(0,0,0,0.12); }
    .dropdown-item { padding:10px 14px; cursor:pointer; font-size:14px; font-family:'Source Serif 4',serif; color:#0A0A0A; border-bottom:1px solid #f0ebe4; display:flex; align-items:center; gap:8px; }
    .dropdown-item:last-child { border-bottom:none; }
    .dropdown-item:hover, .dropdown-item.active { background:#fdf5f5; color:#E3120B; }
    .dropdown-item .thumb-placeholder { width:32px; height:32px; background:#ece7e0; border-radius:2px; flex-shrink:0; display:flex; align-items:center; justify-content:center; font-size:14px; color:#aaa; }
    .dropdown-searching { padding:10px 14px; font-family:'IBM Plex Mono',monospace; color:#aaa; font-size:11px; }
    .tool-footer { background:#0A0A0A; color:#888; font-family:'IBM Plex Mono',monospace; font-size:11px; padding:18px 26px; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px; letter-spacing:0.05em; }
    .tool-footer a { color:#E3120B; text-decoration:none; }
    .tool-footer a:hover { text-decoration:underline; }
    @media print { .no-print { display:none !important; } body { background:#fff; } }
    @media (max-width:680px) { .grid2 { grid-template-columns:1fr !important; } }
  </style>
</head>
<body>
<div id="root"></div>
<script>
'use strict';
const h = React.createElement;
const { useState, useCallback, useRef, useEffect } = React;

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   METADATOS DE CATEGOR√çAS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const CAT_META = {
  relational: { label:'Definici√≥n relacional',      color:'#c0313f', bg:'#fde8ec', icon:'üë•' },
  appearance: { label:'Enfoque en la apariencia',   color:'#b85a0a', bg:'#fdf0e6', icon:'üëÅ'  },
  diminutive: { label:'Lenguaje diminutivo',         color:'#6b30cc', bg:'#f3effd', icon:'‚Üì'  },
  gendered:   { label:'Marca de g√©nero innecesaria', color:'#0c6e63', bg:'#e5f5f3', icon:'‚öß'  },
  omission:   { label:'Minimizaci√≥n de logros',      color:'#1850a0', bg:'#e8f0fc', icon:'üìä' },
  tone:       { label:'Tono condescendiente',        color:'#8a2e2e', bg:'#faeaea', icon:'üí¨' },
};

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   BIBLIOTECA DE PATRONES ‚Äî ESPA√ëOL (49 patrones)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const PATTERNS = [

  // ‚îÄ‚îÄ DEFINICI√ìN RELACIONAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  { cat:'relational', weight:2.2, src:'\\besposa\\s+de\\b|\\bc√≥nyuge\\s+de\\b',
    explain:'Definir a la sujeto como la esposa de alguien sit√∫a su identidad en relaci√≥n con un hombre, no en m√©rito propio. Este encuadre rara vez se aplica a hombres de logros equivalentes.',
    suggest:'Abre con el t√≠tulo profesional de la sujeto o su contribuci√≥n m√°s significativa. Su matrimonio puede mencionarse m√°s adelante como contexto biogr√°fico.',
    rewrites:[
      { from:'Era la esposa del compositor [Nombre] y lo acompa√±aba en sus giras.', to:'Mezzosoprano de reconocimiento internacional, tambi√©n estuvo casada con el compositor [Nombre].' },
      { from:'Como esposa del primer ministro, se convirti√≥ en figura p√∫blica.', to:'Se convirti√≥ en figura p√∫blica por m√©ritos propios como diplom√°tica y, posteriormente, como escritora.' },
      { from:'Nacida en Madrid, era la esposa del industrial [Nombre].', to:'Nacida en Madrid, fue qu√≠mica textil y m√°s tarde contrajo matrimonio con el industrial [Nombre].' },
    ] },

  { cat:'relational', weight:1.7, src:'\\bhija\\s+de\\b',
    explain:'Presentar a la sujeto a trav√©s de su filiaci√≥n familiar antepone el linaje a sus propios logros.',
    suggest:'Comienza con el rol o logro propio de la sujeto. La filiaci√≥n corresponde a una secci√≥n de ¬´Primeros a√±os¬ª, no al encuadre inicial.',
    rewrites:[
      { from:'Hija de un diplom√°tico, se convirti√≥ en arquitecta de renombre.', to:'Arquitecta de renombre, creci√≥ en un hogar diplom√°tico.' },
      { from:'Hija del pintor [Nombre], se form√≥ en la Escuela de Bellas Artes.', to:'Se form√≥ en la Escuela de Bellas Artes y lleg√≥ a superar la reputaci√≥n de su padre, [Nombre].' },
      { from:'Hija de una obrera, lider√≥ el movimiento laboral.', to:'Lider√≥ el movimiento laboral; proced√≠a de una familia obrera.' },
    ] },

  { cat:'relational', weight:2.0, src:'\\bviuda\\s+(?:de|tras)\\b|\\benvi√≥(?:d[ao])\\s+(?:de|tras)\\b',
    explain:'Definir a la sujeto a trav√©s del duelo ancla su identidad a una pareja fallecida en lugar de a su propia obra.',
    suggest:'Elimina o reubica esta referencia. Si es relevante, menciona la muerte de su pareja solo en contexto cronol√≥gico.' },

  { cat:'relational', weight:1.9, src:'\\bsu\\s+(?:marido|esposo|pareja|padre|hermano)\\s+(?:la\\s+)?(?:ayud√≥|anim√≥|apoy√≥|alent√≥|impuls√≥|introdujo|inspir√≥)\\b',
    explain:'Atribuir a una figura masculina el m√©rito de impulsar la carrera de la sujeto implica que ella necesit√≥ apoyo masculino para triunfar. Este sesgo estructural rara vez se aplica a hombres.',
    suggest:'Reformula para mostrar a la sujeto como agente de su propia carrera. Si existi√≥ colaboraci√≥n, descr√≠bela como una relaci√≥n entre iguales.',
    rewrites:[
      { from:'Su marido la anim√≥ a dedicarse a la pintura.', to:'Se dedic√≥ a la pintura a finales de sus veinte a√±os, desarrollando un estilo propio.' },
      { from:'Su padre la introdujo en las matem√°ticas desde peque√±a.', to:'Mostr√≥ desde temprana edad una marcada aptitud para las matem√°ticas, que cultiv√≥ con profesores de la universidad.' },
      { from:'Su hermano la ayud√≥ a acceder al laboratorio.', to:'Obtuvo acceso al laboratorio a trav√©s del programa de investigaci√≥n visitante de la universidad.' },
    ] },

  { cat:'relational', weight:1.5, src:'\\bmadre\\s+de\\s+(?:(?:un[ao]|dos|tres|cuatro|cinco|seis|siete|ocho|\\d+)\\s+)?hijos\\b',
    explain:'Presentar la maternidad antes que la identidad profesional refleja un doble est√°ndar persistente en la escritura biogr√°fica.',
    suggest:'Traslada los detalles familiares a una secci√≥n de ¬´Vida personal¬ª. Establece primero la identidad profesional.' },

  { cat:'relational', weight:2.0, src:'\\bmusa\\s+(?:de|para)\\b',
    explain:'"Musa de" reduce a la sujeto a una fuente pasiva de inspiraci√≥n creativa para otro ‚Äîgeneralmente masculino‚Äî en lugar de reconocerla como agente creativa.',
    suggest:'Describe su propia obra creativa. Si influy√≥ en otro artista, encu√°dralo como intercambio mutuo.',
    rewrites:[
      { from:'Fue la musa del poeta [Nombre].', to:'Fue poeta y pintora; su obra influy√≥ en [Nombre], con quien mantuvo una correspondencia creativa.' },
      { from:'Los artistas de la √©poca la consideraban su musa.', to:'Fue una figura central en la escena art√≠stica de los a√±os veinte y expuso su propia obra junto a la de sus contempor√°neos.' },
    ] },

  { cat:'relational', weight:2.1, src:'\\bla\\s+mujer\\s+detr[a√°]s\\s+de\\b',
    explain:'"La mujer detr√°s de" la sit√∫a en un papel de apoyo secundario respecto al √©xito de un hombre, insinuando que su importancia es derivada.',
    suggest:'Describe sus contribuciones directamente. Si colabor√≥, describe esa colaboraci√≥n como tal.',
    rewrites:[
      { from:'Fue la mujer detr√°s del √©xito pol√≠tico de su marido.', to:'Coordin√≥ la estrategia de campa√±a que llev√≥ a su marido a la victoria electoral.' },
      { from:'Muchos la consideraban la mujer detr√°s del crecimiento de la empresa.', to:'Dirigi√≥ la estrategia de expansi√≥n de la empresa, triplicando los ingresos entre 1990 y 2000.' },
    ] },

  { cat:'relational', weight:1.8, src:'\\bm[a√°]s\\s+conocida\\s+(?:como|por\\s+ser)\\s+(?:la\\s+)?(?:esposa|pareja|hija|madre|novia)\\s+de\\b',
    explain:'Encuadrar la fama principal de la sujeto como una identidad relacional subordina sus propios logros a su v√≠nculo con otra persona.',
    suggest:'Comienza con aquello por lo que la sujeto es conocida en m√©rito propio.',
    rewrites:[
      { from:'Es m√°s conocida como la esposa del compositor [Nombre].', to:'Es conocida por sus propias composiciones y por dirigir la [Orquesta].' },
      { from:'Era m√°s conocida como hija del presidente.', to:'Era conocida como abogada de derechos humanos que defendi√≥ casos hist√≥ricos ante el Tribunal Supremo.' },
    ] },

  // ‚îÄ‚îÄ ENFOQUE EN LA APARIENCIA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  { cat:'appearance', weight:2.0, src:'\\b(?:hermosa|bella|atractiva|guapa|preciosa|deslumbrante|glamurosa|encantadora|ravishing)\\b',
    explain:'Comentar el atractivo f√≠sico de la sujeto rara vez aparece en las biograf√≠as de hombres de logros comparables e implica que la apariencia es una caracter√≠stica definitoria.',
    suggest:'Elimina el descriptor f√≠sico. Si alguna cualidad de presencia es relevante, descr√≠bela en t√©rminos de comportamiento profesional.',
    rewrites:[
      { from:'La hermosa cient√≠fica cautiv√≥ al p√∫blico con su conferencia.', to:'La cient√≠fica cautiv√≥ al p√∫blico con su conferencia.' },
      { from:'Atractiva y brillante, ascendi√≥ r√°pidamente en su carrera.', to:'Ascendi√≥ r√°pidamente en su carrera.' },
    ] },

  { cat:'appearance', weight:2.1, src:'\\b(?:esbelta|delgada|menuda|voluptuosa|curvil√≠nea|escultural)\\s+(?:figura|silueta|cuerpo|f√≠sico)\\b',
    explain:'Describir la figura de una mujer en una biograf√≠a enciclop√©dica es casi siempre irrelevante y la reduce a su forma f√≠sica.',
    suggest:'Elimina completamente. Las dimensiones f√≠sicas no son enciclop√©dicamente relevantes en una biograf√≠a profesional.',
    rewrites:[
      { from:'Su esbelta figura la hac√≠a inconfundible sobre el escenario.', to:'[Eliminar ‚Äî no es enciclop√©dicamente relevante.]' },
      { from:'Su escultural figura impon√≠a atenci√≥n en los actos p√∫blicos.', to:'Impon√≠a atenci√≥n en los actos p√∫blicos.' },
    ] },

  { cat:'appearance', weight:2.2, src:'\\bconocida\\s+(?:tanto\\s+)?por\\s+su\\s+(?:belleza|aspecto|apariencia|figura|elegancia|porte)\\b',
    explain:'Encuadrar los atributos f√≠sicos como raz√≥n principal de la fama de la sujeto margina sus verdaderos logros.',
    suggest:'Sustituye por aquello por lo que es conocida profesionalmente.',
    rewrites:[
      { from:'Era conocida tanto por su belleza como por su investigaci√≥n.', to:'Era conocida por su investigaci√≥n sobre f√≠sica de plasma.' },
      { from:'El p√∫blico la admiraba tanto por su elegancia como por su voz.', to:'El p√∫blico celebraba su poderosa voz de soprano y su interpretaci√≥n de Verdi.' },
    ] },

  { cat:'appearance', weight:1.4, src:'\\bbien\\s+(?:vestida|arreglada|presentada)\\b',
    explain:'Las referencias a la vestimenta y el arreglo personal en contextos biogr√°ficos profesionales se aplican de forma desproporcionada a las mujeres.',
    suggest:'Elimina la referencia. Si la presentaci√≥n es relevante para su trabajo, expl√≠calo directamente.',
    rewrites:[
      { from:'La economista, siempre bien vestida, dirigi√≥ la conferencia.', to:'La economista dirigi√≥ la conferencia.' },
      { from:'Siempre bien arreglada, proyectaba autoridad en cada aparici√≥n p√∫blica.', to:'Proyectaba autoridad en cada aparici√≥n p√∫blica.' },
    ] },

  { cat:'appearance', weight:1.8, src:'\\b(?:radiante|luminosa|vivaz|estilizada)\\b',
    explain:'Estos t√©rminos son principalmente halagos f√≠sicos que rara vez se aplican a hombres en biograf√≠as enciclop√©dicas.',
    suggest:'Elimina el descriptor f√≠sico o reform√∫lalo en t√©rminos de presencia profesional si es genuinamente relevante.',
    rewrites:[
      { from:'La vivaz presentadora se convirti√≥ en un nombre conocido.', to:'La presentadora se convirti√≥ en un nombre conocido gracias a su serie documental.' },
      { from:'Su radiante presencia iluminaba cualquier sala.', to:'[Eliminar ‚Äî no es enciclop√©dicamente relevante.]' },
    ] },

  { cat:'appearance', weight:1.7, src:'\\b(?:fotog√©nica|teleg√©nica)\\b',
    explain:'"Fotog√©nica" y "teleg√©nica" sit√∫an la apariencia visual como una cualidad profesional relevante, lo que se aplica de forma desproporcionada a las mujeres.',
    suggest:'Describe la efectividad medi√°tica o las habilidades comunicativas en t√©rminos profesionales.',
    rewrites:[
      { from:'Su presencia teleg√©nica ayud√≥ a construir una amplia audiencia.', to:'Su claridad comunicativa y fluidez medi√°tica le ayudaron a construir una amplia audiencia.' },
      { from:'Se la consideraba muy fotog√©nica y aparec√≠a con frecuencia en la prensa.', to:'Recibi√≥ amplia cobertura de prensa tras su vuelo en solitario r√©cord.' },
    ] },

  // ‚îÄ‚îÄ LENGUAJE DIMINUTIVO ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  { cat:'diminutive', weight:2.5, src:'\\bsolo\\s+(?:una\\s+)?(?:chica|mujer|ama\\s+de\\s+casa|madre|enfermera|secretaria)\\b',
    explain:'"Solo" minimiza la identidad o el puesto de la sujeto, implicando que es insuficiente o irrelevante.',
    suggest:'Elimina "solo". Describe el rol o puesto sin calificativo.',
    rewrites:[
      { from:'Era solo una secretaria cuando invent√≥ el proceso.', to:'Era secretaria cuando desarroll√≥ el proceso.' },
      { from:'Era solo un ama de casa cuando su novela fue aceptada para publicaci√≥n.', to:'Termin√≥ su primera novela mientras se ocupaba del hogar.' },
    ] },

  { cat:'diminutive', weight:2.3, src:'\\bmeramente\\s+(?:una\\s+)?(?:chica|mujer|secretaria|asistente|enfermera|maestra|empleada)\\b',
    explain:'"Meramente" clasifica impl√≠citamente el puesto de la sujeto como bajo o poco importante.',
    suggest:'Elimina "meramente". Describe el punto de partida de forma neutra.',
    rewrites:[
      { from:'Era meramente una enfermera antes de que su investigaci√≥n transformara la medicina.', to:'Comenz√≥ su carrera como enfermera; su investigaci√≥n posterior transform√≥ el campo.' },
      { from:'Era meramente una maestra cuando escribi√≥ el art√≠culo.', to:'Era profesora de secundaria cuando escribi√≥ el art√≠culo que atrajo atenci√≥n internacional.' },
    ] },

  { cat:'diminutive', weight:2.5, src:'\\ba\\s+pesar\\s+de\\s+(?:ser\\s+)?(?:una\\s+)?(?:mujer|madre|esposa)\\b',
    explain:'"A pesar de ser mujer" enmarca la condici√≥n de mujer en s√≠ misma como un obst√°culo para el √©xito.',
    suggest:'Elimina esta construcci√≥n. Si existi√≥ discriminaci√≥n estructural, n√≥mbrala espec√≠ficamente.',
    rewrites:[
      { from:'A pesar de ser mujer, lider√≥ la expedici√≥n al √Årtico.', to:'A pesar de ser excluida del programa oficial, lider√≥ la expedici√≥n al √Årtico.' },
      { from:'A pesar de ser madre de tres hijos, complet√≥ su doctorado.', to:'Complet√≥ su doctorado en 1961.' },
    ] },

  { cat:'diminutive', weight:2.0, src:'\\bsorprendentemente\\s+(?:logr√≥|consigui√≥|alcanz√≥|lleg√≥|gan√≥|public√≥|complet√≥|obtuvo)\\b',
    explain:'"Sorprendentemente" codifica una expectativa de g√©nero sobre qui√©n se espera que triunfe.',
    suggest:'Elimina "sorprendentemente". Enuncia el logro directamente.',
    rewrites:[
      { from:'Sorprendentemente logr√≥ ganar el premio.', to:'Gan√≥ el premio.' },
      { from:'Sorprendentemente consigui√≥ una puntuaci√≥n perfecta.', to:'Obtuvo una puntuaci√≥n perfecta.' },
    ] },

  { cat:'diminutive', weight:1.5, src:'\\bpudo\\s+(?:completar|terminar|ganar|lograr|conseguir|publicar|escribir|liderar)\\b',
    explain:'"Pudo" implica que el logro fue un esfuerzo extraordinario, lo que se aplica de forma desproporcionada a las mujeres.',
    suggest:'Sustituye por un verbo activo directo.',
    rewrites:[
      { from:'Pudo publicar tres art√≠culos ese a√±o.', to:'Public√≥ tres art√≠culos ese a√±o.' },
      { from:'Pudo completar su tesis mientras trabajaba a tiempo completo.', to:'Complet√≥ su tesis mientras trabajaba a tiempo completo.' },
    ] },

  { cat:'diminutive', weight:1.8, src:'\\b(?:joven\\s+)?(?:chica|ni√±a)\\b',
    skipCtx:'\\b(?:dio\\s+a\\s+luz\\s+(?:a\\s+)?una|tuvo\\s+una\\s+(?:beb√©\\s+)?|su\\s+(?:beb√©\\s+)?|bienvenida\\s+a\\s+una|una\\s+(?:peque√±a|beb√©)\\s+)(?:chica|ni√±a)\\b',
    explain:'Usar "chica" o "ni√±a" para describir a una mujer adulta la infantiliza.',
    suggest:'Sustituye por "mujer". Si literalmente era una ni√±a en ese momento, especifica la edad.',
    rewrites:[
      { from:'La chica de la Espa√±a rural llegar√≠a a ganar el Premio Nobel.', to:'La mujer de la Espa√±a rural llegar√≠a a ganar el Premio Nobel.' },
      { from:'Una tranquila chica de Sevilla que conmovi√≥ al mundo.', to:'Una mujer de Sevilla cuyo activismo cambi√≥ la pol√≠tica educativa internacional.' },
    ] },

  { cat:'diminutive', weight:1.6, src:'\\bpoco\\s+conocida\\b',
    explain:'"Poco conocida" puede codificar inconscientemente la suposici√≥n de que las contribuciones de las mujeres son oscuras cuando simplemente pueden estar infradocumentadas.',
    suggest:'Considera si esto refleja una oscuridad hist√≥rica real o una brecha documental.',
    rewrites:[
      { from:'La poco conocida qu√≠mica descubri√≥ el compuesto en 1921.', to:'La qu√≠mica, cuya obra fue en gran parte ignorada en vida, descubri√≥ el compuesto en 1921.' },
      { from:'Sigue siendo una figura poco conocida pese a sus contribuciones.', to:'Sus contribuciones han sido ampliamente ignoradas en las historias est√°ndar del campo.' },
    ] },

  { cat:'diminutive', weight:1.8, src:'\\bsilenciosamente\\s+(?:logr√≥|trabaj√≥|contribuy√≥|consigui√≥|construy√≥|desarroll√≥|lider√≥|fund√≥|escribi√≥|public√≥)\\b',
    explain:'"Silenciosamente logr√≥" implica que la obra de la sujeto fue modesta o discreta, minimizando su relevancia real.',
    suggest:'Elimina "silenciosamente". Enuncia el logro directamente.',
    rewrites:[
      { from:'Silenciosamente construy√≥ una de las colecciones de arte m√°s importantes del siglo.', to:'Reuni√≥ una de las colecciones de arte m√°s importantes del siglo.' },
      { from:'A lo largo de tres d√©cadas, silenciosamente se estableci√≥ como la principal autoridad.', to:'A lo largo de tres d√©cadas, se estableci√≥ como la principal autoridad.' },
    ] },

  { cat:'diminutive', weight:1.9, src:'\\bsin\\s+embargo\\s+(?:ella\\s+)?(?:persisti√≥|continu√≥|sigui√≥\\s+adelante|persever√≥)\\b',
    explain:'"Sin embargo persisti√≥" enmarca la continuidad como notable, implicando que la persistencia era inesperada o improbable.',
    suggest:'Enuncia directamente lo que hizo. Si existieron obst√°culos, n√≥mbralos expl√≠citamente.',
    rewrites:[
      { from:'Sin embargo, persisti√≥ y complet√≥ su doctorado.', to:'A pesar de que le negaron el acceso al laboratorio, complet√≥ su doctorado en 1934.' },
      { from:'Sin embargo, ella continu√≥ y finalmente obtuvo reconocimiento.', to:'El reconocimiento lleg√≥ solo despu√©s de d√©cadas de resistencia institucional a sus hallazgos.' },
    ] },

  { cat:'diminutive', weight:1.7, src:'\\bsolo\\s+(?:una\\s+)?(?:mujer|chica|ama\\s+de\\s+casa|madre|secretaria|enfermera|asistente)\\b',
    explain:'"Solo una mujer" funciona como "meramente" ‚Äîminimiza su identidad o punto de partida.',
    suggest:'Elimina "solo". Describe el rol directamente.',
    rewrites:[
      { from:'Era solo un ama de casa cuando escribi√≥ su primera novela.', to:'Escribi√≥ su primera novela mientras se ocupaba del hogar.' },
      { from:'Era solo una enfermera; sin embargo, su investigaci√≥n fue transformadora.', to:'Era enfermera cuando su investigaci√≥n transform√≥ los protocolos de tratamiento.' },
    ] },

  // ‚îÄ‚îÄ MARCA DE G√âNERO INNECESARIA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  { cat:'gendered', weight:1.9, src:'\\bmujer\\s+(?:m√©dico|piloto|ingeniero|cient√≠fico|arquitecto|matem√°tico|f√≠sico|qu√≠mico|director|general|almirante|juez|cirujano|senador|presidente|ejecutivo)\\b',
    explain:'A√±adir el calificativo "mujer" a un t√≠tulo profesional masculino implica que la profesi√≥n es masculina por defecto.',
    suggest:'Usa la forma femenina del t√≠tulo profesional directamente, sin calificativo adicional.',
    rewrites:[
      { from:'Era mujer m√©dico en un hospital p√∫blico.', to:'Era m√©dica en un hospital p√∫blico.' },
      { from:'Fue una de las pocas mujeres piloto de su generaci√≥n.', to:'Fue una de las pocas pilotas de su generaci√≥n.' },
    ] },

  { cat:'gendered', weight:1.7, src:'\\b(?:escritora|poeta|pintora|artista|escultora|fot√≥grafa|directora|productora|compositora|int√©rprete)\\s+(?:femenina|mujer)\\b',
    explain:'A√±adir un calificativo de g√©nero a profesiones creativas implica que la identidad art√≠stica es masculina por defecto.',
    suggest:'Usa √∫nicamente el t√≠tulo profesional.',
    rewrites:[
      { from:'Era una c√©lebre escritora femenina.', to:'Era una c√©lebre escritora.' },
      { from:'Como directora de cine femenina, luch√≥ por la financiaci√≥n.', to:'Luch√≥ por la financiaci√≥n a lo largo de su carrera, enfrent√°ndose a barreras sist√©micas en la industria.' },
    ] },

  { cat:'gendered', weight:2.2, src:'\\bpara\\s+(?:ser\\s+)?(?:una\\s+)?mujer\\b',
    explain:'"Para ser mujer" mide el logro de la sujeto con un est√°ndar de g√©nero en lugar de uno absoluto.',
    suggest:'Elimina "para ser mujer" por completo. Describe el logro en t√©rminos absolutos.',
    rewrites:[
      { from:'Su producci√≥n matem√°tica era extraordinaria para ser mujer.', to:'Su producci√≥n matem√°tica era extraordinaria.' },
      { from:'Escrib√≠a con una claridad inusual para ser mujer de su √©poca.', to:'Escrib√≠a con una claridad inusual para la √©poca.' },
    ] },

  { cat:'gendered', weight:1.4, src:'\\bprimera\\s+mujer\\s+en\\s+(?:ganar|recibir|ocupar|ser|llegar|liderar|servir|dirigir)\\b',
    explain:'"Primera mujer en" usado descuidadamente implica que las mujeres son inherentemente menos esperadas en un rol.',
    suggest:'Si es genuinamente significativo, contextual√≠zalo: explica qu√© barreras estructurales exclu√≠an previamente a las mujeres.' },

  { cat:'gendered', weight:1.8, src:'\\b(?:mujer\\s+de\\s+carrera|madre\\s+trabajadora|esposa\\s+trabajadora)\\b',
    explain:'"Mujer de carrera" y "madre trabajadora" son construcciones de g√©nero sin equivalentes masculinos comunes.',
    suggest:'Describe su profesi√≥n directamente.',
    rewrites:[
      { from:'Como mujer de carrera, naveg√≥ por un sector dominado por hombres.', to:'Como ingeniera, naveg√≥ por un sector que exclu√≠a sistem√°ticamente a las mujeres del liderazgo.' },
      { from:'Fue una madre trabajadora que encontr√≥ tiempo para escribir.', to:'Public√≥ su primera novela en 1962.' },
    ] },

  { cat:'gendered', weight:1.6, src:'\\b(?:marimacho|chicazo|tomboy)\\b',
    explain:'"Marimacho" enmarca los intereses de una ni√±a como no conformes con su g√©nero, implicando que ciertas actividades son inherentemente masculinas.',
    suggest:'Describe los intereses espec√≠ficos directamente.',
    rewrites:[
      { from:'Era una marimacho de peque√±a: prefer√≠a los coches a las mu√±ecas.', to:'Desde peque√±a se sent√≠a atra√≠da por los motores y pasaba sus fines de semana desmontando maquinaria.' },
    ] },

  { cat:'gendered', weight:1.5, src:'\\b(?:poco\\s+femenina|muy\\s+femenina|falta\\s+de\\s+feminidad)\\b',
    explain:'Estas expresiones aplican un c√≥digo de conducta de g√©nero, implicando que las mujeres deben ajustarse a un est√°ndar comportamental determinado.',
    suggest:'Describe el comportamiento directamente sin el marco evaluativo de g√©nero.',
    rewrites:[
      { from:'Su franqueza, poco femenina, escandaliz√≥ a sus contempor√°neos.', to:'Su franqueza escandaliz√≥ a muchos de sus contempor√°neos.' },
      { from:'Los cr√≠ticos la encontraban demasiado agresiva y poco femenina.', to:'Los cr√≠ticos la encontraban demasiado directa para el protocolo de la √©poca.' },
    ] },

  // ‚îÄ‚îÄ MINIMIZACI√ìN DE LOGROS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  { cat:'omission', weight:1.4, src:'\\bfue\\s+(?:galardonada|premiada|reconocida|honrada|nombrada|elegida|designada)\\s+(?:con|como)?\\b',
    explain:'La voz pasiva elimina la agencia de la sujeto. "Fue galardonada" la convierte en receptora pasiva en lugar de merecedora activa.',
    suggest:'Reescribe en voz activa.',
    rewrites:[
      { from:'Fue galardonada con el Premio Nobel en 1963.', to:'Recibi√≥ el Premio Nobel en 1963.' },
      { from:'Fue premiada con el Premio Cervantes por su obra.', to:'Obtuvo el Premio Cervantes por su obra.' },
    ] },

  { cat:'omission', weight:1.9, src:'\\bmientras\\s+(?:tambi√©n\\s+)?(?:criaba|cuidaba\\s+a|se\\s+ocupaba\\s+de)\\s+(?:sus\\s+)?(?:hijos|familia|ni√±os|hijo|hija)\\b',
    explain:'A√±adir las responsabilidades dom√©sticas a los logros profesionales implica que estos est√°n en tensi√≥n, un encuadre que rara vez se aplica a los hombres.',
    suggest:'Si los detalles familiares son relevantes, dales su propia oraci√≥n en una secci√≥n de ¬´Vida personal¬ª.',
    rewrites:[
      { from:'Escribi√≥ cuatro novelas mientras tambi√©n criaba a tres hijos.', to:'Escribi√≥ cuatro novelas durante la d√©cada de 1960.' },
      { from:'Lider√≥ el departamento mientras cuidaba a sus padres mayores.', to:'Lider√≥ el departamento a lo largo de la d√©cada de 1980.' },
    ] },

  { cat:'omission', weight:2.0, src:'\\bcompaginando\\s+(?:su\\s+)?(?:carrera|trabajo|vida\\s+profesional)\\s+(?:con|y)\\s+(?:su\\s+)?(?:familia|hijos|maternidad|vida\\s+dom√©stica)\\b',
    explain:'"Compaginando carrera y familia" se aplica casi exclusivamente a mujeres en la biograf√≠a.',
    suggest:'Elimina el encuadre de "compaginar". Describe la vida profesional y personal por separado.',
    rewrites:[
      { from:'Compaginando su carrera con la maternidad, public√≥ de manera prol√≠fica.', to:'Public√≥ de manera prol√≠fica a lo largo de la d√©cada de 1970.' },
      { from:'Compaginando su vida profesional y sus responsabilidades familiares, encontr√≥ tiempo para componer.', to:'Compuso de manera prol√≠fica, completando seis sinfon√≠as entre 1955 y 1970.' },
    ] },

  { cat:'omission', weight:1.7, src:'\\bdespu√©s\\s+de\\s+(?:su\\s+)?(?:matrimonio|boda|casarse|criar\\s+a\\s+sus\\s+hijos)\\b',
    explain:'Secuenciar los logros profesionales despu√©s de los hitos dom√©sticos implica que la carrera era secundaria.',
    suggest:'Reordena para comenzar con la cronolog√≠a profesional.' },

  { cat:'omission', weight:1.9, src:'\\b(?:tropez√≥\\s+(?:con|en)|descubri√≥\\s+por\\s+casualidad|lleg√≥\\s+por\\s+accidente|se\\s+top√≥\\s+con)\\b',
    explain:'"Tropez√≥ con" enmarca el descubrimiento como accidental en lugar de fruto de la pericia deliberada y el trabajo sostenido.',
    suggest:'Usa lenguaje activo e intencional: "descubri√≥", "su investigaci√≥n llev√≥ a", "identific√≥".',
    rewrites:[
      { from:'Tropez√≥ con la f√≥rmula mientras limpiaba el laboratorio.', to:'Identific√≥ la f√≥rmula durante el trabajo rutinario de laboratorio.' },
      { from:'Se top√≥ con el manuscrito en un archivo de Par√≠s.', to:'Su investigaci√≥n archiv√≠stica en Par√≠s sac√≥ a la luz el manuscrito.' },
    ] },

  { cat:'omission', weight:1.7, src:'\\bsu\\s+(?:modesta|peque√±a|humilde|menor|escasa)\\s+(?:contribuci√≥n|aportaci√≥n|papel|logro)\\b',
    explain:'Calificar la contribuci√≥n de la sujeto como "modesta" o "peque√±a" impone un juicio diminutivo antes de que el lector pueda evaluarla.',
    suggest:'Describe la contribuci√≥n y deja que el lector eval√∫e su importancia.',
    rewrites:[
      { from:'Su modesta contribuci√≥n al campo fue ampliamente citada.', to:'Su contribuci√≥n al campo fue ampliamente citada.' },
      { from:'Desempe√±√≥ un peque√±o papel en el desarrollo de la teor√≠a.', to:'Contribuy√≥ al desarrollo de la teor√≠a aportando los datos experimentales en que se basa el modelo.' },
    ] },

  { cat:'omission', weight:1.6, src:'\\b(?:ayud√≥|asisti√≥|apoy√≥|auxili√≥)\\s+(?:a\\s+)?(?:desarrollar|crear|descubrir|establecer|fundar|construir|escribir|liderar)\\b',
    explain:'"Ayud√≥" o "asisti√≥" donde la sujeto pudo ser la principal contribuyente minimiza su papel e implica que fue secundaria.',
    suggest:'Verifica su papel real. Si lider√≥ o co-lider√≥, usa "lider√≥", "codise√±√≥" o "cre√≥".',
    rewrites:[
      { from:'Ayud√≥ a desarrollar el algoritmo.', to:'Codise√±√≥ el algoritmo.' },
      { from:'Ayud√≥ a fundar la organizaci√≥n en 1948.', to:'Fue cofundadora de la organizaci√≥n en 1948.' },
    ] },

  // ‚îÄ‚îÄ TONO CONDESCENDIENTE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  { cat:'tone', weight:2.0, src:'\\b(?:luchadora|bravucona|respondona|peleona)\\b',
    explain:'Estos t√©rminos se aplican casi exclusivamente a mujeres e implican que su asertividad es inusual o curiosa.',
    suggest:'Sustituye por un descriptor neutro.',
    rewrites:[
      { from:'La luchadora activista se neg√≥ a ceder.', to:'La tenaz activista se neg√≥ a ceder.' },
      { from:'Su actitud bravucona le gan√≥ admiradores.', to:'Su persistencia le gan√≥ admiradores.' },
    ] },

  { cat:'tone', weight:1.9, src:'\\bvalerosa\\b',
    explain:'"Valerosa" con tono diminutivo sugiere coraje de manera condescendiente, como si fuera inesperado en una mujer.',
    suggest:'Usa "valiente", "decidida" o "persistente" sin el subtexto de sorpresa.',
    rewrites:[
      { from:'La valerosa joven investigadora sigui√≥ adelante.', to:'La decidida joven investigadora sigui√≥ adelante.' },
      { from:'Era una valerosa pionera que desafi√≥ al sistema.', to:'Desafi√≥ activamente las barreras institucionales durante toda su carrera.' },
    ] },

  { cat:'tone', weight:1.8, src:'\\b(?:descarada|atrevida|insolente)\\b',
    explain:'Estos t√©rminos trivializan el ingenio o la asertividad de la mujer con un t√©rmino de g√©nero.',
    suggest:'Describe la cualidad espec√≠fica con mayor precisi√≥n.',
    rewrites:[
      { from:'Sus descaradas respuestas conquistaron al p√∫blico.', to:'Su agudo ingenio conquist√≥ al p√∫blico.' },
      { from:'Era conocida por su atrevida presencia esc√©nica.', to:'Era conocida por su imponente presencia esc√©nica.' },
    ] },

  { cat:'tone', weight:2.1, src:'\\b(?:sorprendentemente|asombrosamente|incre√≠blemente),?\\s+(?:ella\\s+)?(?:se\\s+convirti√≥|logr√≥|consigui√≥|lleg√≥|gan√≥|public√≥|alcanz√≥)\\b',
    explain:'Los adverbios de sorpresa codifican una expectativa de g√©nero sobre qui√©n se espera que triunfe.',
    suggest:'Elimina el adverbio de sorpresa. Enuncia el logro directamente.',
    rewrites:[
      { from:'Sorprendentemente, se convirti√≥ en jefa del departamento a los treinta a√±os.', to:'Se convirti√≥ en jefa del departamento a los treinta a√±os.' },
      { from:'Asombrosamente, public√≥ veinte art√≠culos antes de los veinticinco.', to:'Antes de los veinticinco a√±os hab√≠a publicado veinte art√≠culos.' },
    ] },

  { cat:'tone', weight:1.5, src:'\\bdesafi√≥\\s+(?:las\\s+)?(?:probabilidades|expectativas|convenciones|los\\s+estereotipos)\\b',
    explain:'"Desafi√≥ las probabilidades" implica que el √©xito era inherentemente improbable, a menudo codificando supuestos de g√©nero.',
    suggest:'Si existieron barreras estructurales reales, n√≥mbralas expl√≠citamente.',
    rewrites:[
      { from:'Desafi√≥ las probabilidades para convertirse en cirujana.', to:'A pesar de ser excluida de los programas de formaci√≥n quir√∫rgica hasta 1968, se convirti√≥ en cirujana.' },
      { from:'Desafi√≥ las expectativas y gan√≥ el campeonato.', to:'Gan√≥ el campeonato despu√©s de entrenarse por su cuenta al serle negado el acceso al programa nacional.' },
    ] },

  { cat:'tone', weight:1.3, src:'\\bmodelo\\s+a\\s+seguir\\s+para\\s+(?:las\\s+)?(?:mujeres|chicas|j√≥venes\\s+mujeres)\\b',
    explain:'Encuadrar el significado de la sujeto principalmente como modelo para otras mujeres limita su impacto a una esfera de g√©nero.',
    suggest:'Describe primero su contribuci√≥n al campo en su conjunto.',
    rewrites:[
      { from:'Se convirti√≥ en un modelo a seguir para las j√≥venes cient√≠ficas.', to:'Su trabajo en cromodin√°mica cu√°ntica avanz√≥ el campo; tambi√©n se convirti√≥ en una figura prominente para las mujeres que acceden a la f√≠sica.' },
      { from:'Es vista ampliamente como un modelo a seguir para las ni√±as en el deporte.', to:'Es una de las deportistas m√°s laureadas en la historia de su disciplina.' },
    ] },

  { cat:'tone', weight:2.1, src:'\\b(?:hist√©rica|estridente|respondona|mandona|brusca|harpia)\\b',
    explain:'Estos t√©rminos patologizan o trivializan la expresi√≥n asertiva y se aplican casi exclusivamente a las mujeres.',
    suggest:'Elimina el t√©rmino por completo. Si su estilo comunicativo es relevante, descr√≠belo neutralmente.',
    rewrites:[
      { from:'Los cr√≠ticos la llamaban estridente y mandona.', to:'Los cr√≠ticos la describ√≠an como contundente y directa.' },
      { from:'Fue tachada de hist√©rica por sus detractores.', to:'Sus detractores intentaron desacreditar sus argumentos atacando sus formas en lugar de sus pruebas.' },
    ] },

  { cat:'tone', weight:1.8, src:'\\b(?:demasiado|muy)\\s+(?:emocional|sensible|dram√°tica|apasionada)\\b',
    explain:'Calificar a una mujer de "demasiado emocional" patologiza la expresi√≥n emocional de forma desproporcionada.',
    suggest:'Elimina el calificativo. Describe la situaci√≥n espec√≠fica sin evaluar la idoneidad de su respuesta.',
    rewrites:[
      { from:'Algunos colegas la encontraban demasiado emocional en las reuniones.', to:'Algunos colegas chocaban con su enfoque en las reuniones.' },
      { from:'Los cr√≠ticos sent√≠an que era demasiado apasionada para ser objetiva.', to:'Los cr√≠ticos cuestionaban si su implicaci√≥n personal en la causa afectaba a su an√°lisis.' },
    ] },

  { cat:'tone', weight:1.6, src:'\\b(?:muy\\s+opinante|demasiado\\s+opinante|cargada\\s+de\\s+opiniones)\\b',
    explain:'Describir a una mujer como "muy opinante" enmarca sus convicciones firmes como un defecto de personalidad, algo que rara vez se aplica a hombres de convicci√≥n equivalente.',
    suggest:'Sustituye por un lenguaje neutro que describa las posiciones que sosten√≠a.',
    rewrites:[
      { from:'La muy opinante periodista era divisiva.', to:'La periodista sosten√≠a posiciones firmes sobre la libertad de prensa y era una figura polarizadora en los c√≠rculos medi√°ticos.' },
    ] },

  { cat:'tone', weight:1.7, src:'\\bambiciosa\\b',
    explain:'"Ambiciosa" aplicado a las mujeres conlleva con mayor frecuencia connotaciones negativas ‚Äîimplicando exceso o agresividad‚Äî que cuando se aplica a los hombres.',
    suggest:'Comprueba el contexto. Si implica exceso, sustit√∫yelo por una descripci√≥n de sus objetivos espec√≠ficos.',
    rewrites:[
      { from:'Su naturaleza ambiciosa alej√≥ a sus colegas.', to:'Su impulso por liderar el departamento gener√≥ fricciones con colegas que prefer√≠an la estructura existente.' },
      { from:'Algunos la ve√≠an como demasiado ambiciosa.', to:'Algunos colegas se resist√≠an a su impulso hacia una reforma institucional r√°pida.' },
    ] },
];

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MAPEADO DE SECCIONES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function buildSectionMap(fullText, apiSections) {
  const map = [{ title: null, charPos: 0, index: 0 }];
  let pos = 0;
  for (const line of fullText.split('\n')) {
    const m = line.match(/^(={2,})\s*(.+?)\s*\1\s*$/);
    if (m) map.push({ title: m[2].trim(), charPos: pos, index: null });
    pos += line.length + 1;
  }
  for (const { index, line: apiTitle } of apiSections) {
    const entry = map.find(s => s.title === apiTitle);
    if (entry) entry.index = parseInt(index);
  }
  return map;
}

function getSectionIndex(sentence, fullText, sectionMap) {
  const pos = fullText.indexOf(sentence.slice(0, 60));
  if (pos === -1) return 0;
  let result = 0;
  for (const sec of sectionMap) {
    if (sec.charPos <= pos && sec.index !== null) result = sec.index;
  }
  return result;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MOTOR DE AN√ÅLISIS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function splitSentences(text) {
  return text
    .replace(/\r\n/g, '\n')
    .replace(/([.!?])\s+([A-Z√Å√â√ç√ì√ö√ë√ú])/g, '$1\n$2')
    .split('\n')
    .map(s => s.trim())
    .filter(s => s.length > 15);
}

function isNegated(sentence, matchIndex) {
  const before = sentence.slice(Math.max(0, matchIndex - 60), matchIndex);
  return /\b(?:no|nunca|jam√°s|sin|tampoco|ni|ninguna|no\s+es|no\s+era|no\s+fue)\b/i.test(before);
}

function getSurroundingQuote(sentences, idx) {
  const parts = [sentences[idx]];
  if (sentences[idx + 1]) parts.push(sentences[idx + 1]);
  const joined = parts.join(' ').trim();
  return joined.length > 400 ? joined.slice(0, 397) + '‚Ä¶' : joined;
}

function analyseArticle(title, fullText, sectionMap, editBase) {
  const sentences  = splitSentences(fullText);
  const totalWords = fullText.split(/\s+/).filter(Boolean).length;
  const instances  = [];
  const usedKeys   = {};

  PATTERNS.forEach(({ cat, weight, src, skipCtx, explain, suggest, rewrites }) => {
    const re     = new RegExp(src, 'gi');
    const skipRe = skipCtx ? new RegExp(skipCtx, 'i') : null;
    sentences.forEach((sentence, idx) => {
      re.lastIndex = 0;
      const match = re.exec(sentence);
      if (!match) return;
      if (isNegated(sentence, match.index)) return;
      if (skipRe && skipRe.test(sentence)) return;
      const key = `${cat}::${sentence.slice(0, 70)}`;
      if (usedKeys[key]) return;
      usedKeys[key] = true;
      const secIdx         = getSectionIndex(sentence, fullText, sectionMap);
      const sectionEditUrl = `${editBase}&section=${secIdx}`;
      instances.push({ cat, weight, quote: getSurroundingQuote(sentences, idx), matchedPhrase: match[0], explain, suggest, rewrites, sectionEditUrl });
    });
  });

  const topInstances = instances.sort((a, b) => b.weight - a.weight).slice(0, 8);

  const catHits = { relational:0, appearance:0, diminutive:0, gendered:0, omission:0, tone:0 };
  instances.forEach(({ cat }) => { catHits[cat]++; });

  // Comprobaciones estructurales
  const structuralNotes = [];
  const openingText  = sentences.slice(0, 6).join(' ');
  const personalHits = (openingText.match(/\b(?:casada|matrimonio|marido|esposo|hijos|madre|hija|hermana|nacida\s+en|su\s+(?:familia|padres|padre|madre))\b/gi) || []).length;
  const profHits     = (openingText.match(/\b(?:carrera|profesi√≥n|trabajo|public√≥|logr√≥|gan√≥|lider√≥|fund√≥|cre√≥|descubri√≥|desarroll√≥|invent√≥|escribi√≥|dirigi√≥|premio|medalla|conocida\s+por|famosa\s+por)\b/gi) || []).length;
  if (personalHits > profHits && personalHits >= 2) {
    structuralNotes.push('Los p√°rrafos iniciales anteponen los detalles personales y familiares a los logros profesionales ‚Äî un patr√≥n estructural m√°s com√∫n en las biograf√≠as de mujeres que en las de hombres.');
  }
  const passiveCount = (fullText.match(/\bfue\s+(?:galardonada|premiada|elegida|seleccionada|nombrada|designada|descrita|considerada)\b/gi) || []).length;
  const passiveRate  = sentences.length > 0 ? passiveCount / sentences.length : 0;
  if (passiveRate > 0.2) {
    structuralNotes.push(`Las construcciones en voz pasiva aparecen en aproximadamente el ${Math.round(passiveRate * 100)}% de las oraciones, eliminando sistem√°ticamente la agencia de la sujeto de su propia narrativa.`);
  }

  const activeCats = Object.entries(catHits).filter(([,v])=>v>0).map(([k])=>CAT_META[k].label);
  let summary;
  if (topInstances.length === 0 && structuralNotes.length === 0) {
    summary = `Este art√≠culo sobre ${title} muestra pocos indicios de sesgo de g√©nero sistem√°tico. El lenguaje es en gran medida neutro y la sujeto recibe un tratamiento que se aplicar√≠a igualmente a sujetos de cualquier g√©nero. Es posible que a√∫n quepan mejoras menores.`;
  } else {
    summary = `Este art√≠culo sobre ${title} contiene patrones detectables de sesgo de g√©nero. `;
    if (activeCats.length > 0) summary += `Se encontraron problemas en las siguientes categor√≠as: ${activeCats.slice(0,3).join(', ')}. `;
    if (structuralNotes.length > 0) summary += `Tambi√©n se detectaron problemas estructurales en la organizaci√≥n del art√≠culo. `;
    summary += `${topInstances.length} pasaje${topInstances.length !== 1 ? 's han' : ' ha'} sido marcado${topInstances.length !== 1 ? 's' : ''} a continuaci√≥n. Como siempre, utiliza tu propio criterio ‚Äî no todo pasaje marcado ser√° sesgado en su contexto espec√≠fico.`;
  }

  const positives = [];
  if (structuralNotes.length === 0 && personalHits <= profHits) positives.push('La apertura establece la identidad profesional de la sujeto en lugar de comenzar con detalles personales o familiares.');
  if (catHits.appearance === 0) positives.push('No se detectaron descripciones innecesarias de la apariencia f√≠sica.');
  if (passiveRate < 0.1) positives.push('El art√≠culo utiliza la voz activa de manera consistente, preservando la agencia de la sujeto en su propia narrativa.');
  if (positives.length === 0) positives.push('El art√≠culo sigue en general una estructura cronol√≥gica, aunque los problemas de lenguaje se√±alados deber√≠an corregirse.');

  return { summary, catHits, instances: topInstances, positives: positives.slice(0, 3), structuralNotes, stats: { totalWords, totalSentences: sentences.length, passiveRate: Math.round(passiveRate * 100) } };
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   API DE WIKIPEDIA (ES)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
async function searchWiki(query) {
  if (!query || query.length < 2) return [];
  const url = `https://es.wikipedia.org/w/api.php?action=opensearch&search=${encodeURIComponent(query)}&limit=8&namespace=0&format=json&origin=*`;
  const res  = await fetch(url);
  const data = await res.json();
  const titles = data[1] || [];
  const descs  = data[2] || [];
  return titles.map((t, i) => ({ title: t, desc: descs[i] || '' }));
}

async function fetchWiki(input) {
  const clean = input.trim().replace(/^https?:\/\/[a-z.]*wikipedia\.org\/wiki\//i, '');
  const url   = `https://es.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(clean)}&prop=extracts|categories&exintro=0&explaintext=1&cllimit=50&format=json&origin=*`;
  const res   = await fetch(url);
  if (!res.ok) throw new Error(`La API de Wikipedia devolvi√≥ el c√≥digo ${res.status}.`);
  const data  = await res.json();
  const page  = Object.values(data.query.pages)[0];
  if (page.missing !== undefined) throw new Error('Art√≠culo no encontrado en Wikipedia. Comprueba el t√≠tulo o la URL.');

  const text = page.extract || '';
  if (text.length < 100) throw new Error('El texto del art√≠culo es demasiado breve o no pudo recuperarse.');

  // Verificaci√≥n de biograf√≠a de mujer
  const cats = (page.categories || []).map(c => c.title.toLowerCase());
  const womenCatHit = cats.some(c =>
    /\bmujeres\b|\bfemenin[ao]\b|\bactriz\b|\breina\b|\bemperatriz\b|\bduquesa\b|\bprincesa\b/.test(c)
  );
  const excerpt    = text.slice(0, 3000).toLowerCase();
  const ellaCount  = (excerpt.match(/\b(?:ella|su|sus|s√≠\s+misma|se\s+convirti√≥|naci√≥|fue\s+una)\b/g) || []).length;
  const elCount    = (excerpt.match(/\b(?:√©l|su\s+padre|su\s+esposo|se\s+convirti√≥\s+en\s+el)\b/g) || []).length;
  const isFemaleSubject = womenCatHit || (ellaCount > elCount && ellaCount >= 3);

  if (!isFemaleSubject) {
    throw new Error(
      `"${page.title}" est√° fuera del alcance de esta herramienta. ` +
      'Analiza el sesgo de g√©nero espec√≠ficamente en biograf√≠as de mujeres en Wikipedia. ' +
      'Por favor, busca la biograf√≠a de una mujer para continuar.'
    );
  }

  const slug = encodeURIComponent(page.title.replace(/ /g, '_'));
  const editBase = `https://es.wikipedia.org/w/index.php?title=${slug}&action=edit`;

  let apiSections = [];
  try {
    const secRes  = await fetch(`https://es.wikipedia.org/w/api.php?action=parse&page=${encodeURIComponent(page.title)}&prop=sections&format=json&origin=*`);
    const secData = await secRes.json();
    apiSections = secData.parse?.sections || [];
  } catch(_) {}

  return { text, title: page.title, url: `https://es.wikipedia.org/wiki/${slug}`, editBase, editUrl: editBase, apiSections };
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   COMPONENTES DE UI
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function SearchDropdown({ value, onChange, onSelect, onSubmit }) {
  const [results, setResults]   = useState([]);
  const [searching, setSearch]  = useState(false);
  const [open, setOpen]         = useState(false);
  const [activeIdx, setActive]  = useState(-1);
  const debounceRef = useRef(null);
  const wrapRef     = useRef(null);

  useEffect(() => {
    const handler = e => { if (wrapRef.current && !wrapRef.current.contains(e.target)) setOpen(false); };
    document.addEventListener('mousedown', handler);
    return () => document.removeEventListener('mousedown', handler);
  }, []);

  useEffect(() => {
    clearTimeout(debounceRef.current);
    if (value.length < 2) { setResults([]); setOpen(false); return; }
    setSearch(true);
    debounceRef.current = setTimeout(async () => {
      try {
        const hits = await searchWiki(value);
        setResults(hits); setOpen(hits.length > 0); setActive(-1);
      } catch(_) { setResults([]); }
      finally { setSearch(false); }
    }, 280);
    return () => clearTimeout(debounceRef.current);
  }, [value]);

  const pick = item => { onSelect(item.title); setOpen(false); setResults([]); };

  const handleKey = e => {
    if (!open) { if (e.key === 'Enter') onSubmit(); return; }
    if (e.key === 'ArrowDown') { e.preventDefault(); setActive(i => Math.min(i+1, results.length-1)); }
    else if (e.key === 'ArrowUp') { e.preventDefault(); setActive(i => Math.max(i-1, -1)); }
    else if (e.key === 'Enter') { e.preventDefault(); if (activeIdx >= 0 && results[activeIdx]) pick(results[activeIdx]); else { setOpen(false); onSubmit(); } }
    else if (e.key === 'Escape') setOpen(false);
  };

  return h('div', { className:'dropdown-wrap', ref: wrapRef },
    h('div', { style:{ position:'relative' } },
      h('input', { type:'text', value, autoComplete:'off', placeholder:'Busca en Wikipedia la biograf√≠a de una mujer‚Ä¶', onChange: e => onChange(e.target.value), onFocus: () => { if (results.length > 0) setOpen(true); }, onKeyDown: handleKey,
        style:{ width:'100%', padding:'13px 40px 13px 15px', fontSize:15, border:'1.5px solid #C8B8A8', borderRadius:3, background:'#fff', fontFamily:"'Source Serif 4',serif", color:'#0A0A0A' } }),
      searching && h('div', { style:{ position:'absolute', right:12, top:'50%', transform:'translateY(-50%)', width:16, height:16, border:'2px solid #E3120B', borderTopColor:'transparent', borderRadius:'50%', animation:'spin .7s linear infinite' } })
    ),
    open && h('div', { className:'dropdown-list' },
      results.length === 0
        ? h('div', { className:'dropdown-searching' }, 'Sin resultados')
        : results.map((item, i) =>
            h('div', { key: item.title, className:`dropdown-item${i===activeIdx?' active':''}`, onMouseDown:()=>pick(item), onMouseEnter:()=>setActive(i) },
              h('div', { className:'thumb-placeholder' }, '‚ôÄ'),
              h('div', { style:{ flex:1, minWidth:0 } },
                h('div', { style:{ fontWeight:600, fontSize:14, whiteSpace:'nowrap', overflow:'hidden', textOverflow:'ellipsis' } }, item.title),
                item.desc && h('div', { style:{ fontSize:11, color:'#888', fontFamily:"'IBM Plex Mono',monospace", marginTop:2, whiteSpace:'nowrap', overflow:'hidden', textOverflow:'ellipsis' } }, item.desc)
              )
            )
          )
    )
  );
}

function CatPill({ catKey, count }) {
  const c = CAT_META[catKey];
  if (count === 0) return null;
  return h('span', { style:{ display:'inline-flex', alignItems:'center', gap:5, padding:'3px 10px', background:c.bg, color:c.color, fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.08em', textTransform:'uppercase', fontWeight:700, marginRight:5, marginBottom:5, border:`1px solid ${c.color}33` } },
    `${c.icon} ${c.label} (${count})`);
}

function InstanceCard({ inst }) {
  const [open, setOpen] = useState(false);
  const c = CAT_META[inst.cat] || CAT_META.tone;
  const shortQuote = inst.quote.length > 130 ? inst.quote.slice(0, 127) + '‚Ä¶' : inst.quote;
  const example = React.useMemo(() => {
    if (!inst.rewrites || inst.rewrites.length === 0) return null;
    return inst.rewrites[Math.floor(Math.random() * inst.rewrites.length)];
  }, [inst.rewrites]);

  return h('div', { className:'inst-row', style:{ background:'#fff', borderLeft:`4px solid ${c.color}`, border:`1px solid ${c.color}22`, borderLeft:`4px solid ${c.color}`, marginBottom:9 } },
    h('button', { onClick:()=>setOpen(o=>!o), style:{ width:'100%', background:'none', border:'none', padding:'13px 16px', textAlign:'left', cursor:'pointer', display:'flex', gap:10, alignItems:'flex-start' } },
      h('span', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.1em', textTransform:'uppercase', padding:'3px 8px', background:c.bg, color:c.color, whiteSpace:'nowrap', marginTop:1, flexShrink:0, fontWeight:700 } }, `${c.icon} ${c.label}`),
      h('span', { style:{ fontSize:14, lineHeight:1.6, color:'#555', fontStyle:'italic', flex:1 } }, `"${shortQuote}"`),
      h('span', { style:{ color:'#ccc', fontSize:12, marginTop:2, flexShrink:0 } }, open?'‚ñ≤':'‚ñº')
    ),
    open && h('div', { style:{ padding:'0 16px 16px' } },
      h('div', { style:{ marginBottom:10 } },
        h('span', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.12em', textTransform:'uppercase', color:'#888' } }, 'Frase detectada: '),
        h('code', { style:{ background:'#fff3cd', padding:'1px 6px', fontSize:13, color:'#7a5400', border:'1px solid #f0d060' } }, inst.matchedPhrase)
      ),
      h('div', { style:{ padding:'11px 15px', background:c.bg, fontSize:14, lineHeight:1.75, fontStyle:'italic', color:'#444', marginBottom:12 } }, `"${inst.quote}"`),
      h('div', { style:{ marginBottom:12 } },
        h('div', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.13em', textTransform:'uppercase', color:'#888', marginBottom:4 } }, 'Por qu√© es sesgado'),
        h('div', { style:{ fontSize:14, lineHeight:1.75, color:'#444', fontWeight:300 } }, inst.explain)
      ),
      h('div', { style:{ padding:'11px 15px', background:'#e9f6ee', border:'1px solid #b8dfc9', marginBottom:12 } },
        h('div', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.13em', textTransform:'uppercase', color:'#1a7a4a', marginBottom:4 } }, 'Enfoque sugerido'),
        h('div', { style:{ fontSize:14, lineHeight:1.75, color:'#1a3a28', fontWeight:300 } }, inst.suggest)
      ),
      example && h('div', { style:{ marginBottom:12 } },
        h('div', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.13em', textTransform:'uppercase', color:'#888', marginBottom:8 } }, 'Ejemplo de reescritura'),
        h('div', { style:{ display:'flex', flexDirection:'column', gap:6 } },
          h('div', { style:{ display:'flex', gap:10, alignItems:'baseline' } },
            h('span', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, color:'#c0392b', letterSpacing:'0.1em', textTransform:'uppercase', flexShrink:0, marginTop:2 } }, 'Antes'),
            h('div', { style:{ fontSize:13, lineHeight:1.65, color:'#999', fontStyle:'italic', textDecoration:'line-through', textDecorationColor:'#e0a0a0' } }, example.from)
          ),
          h('div', { style:{ display:'flex', gap:10, alignItems:'baseline' } },
            h('span', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, color:'#1a7a4a', letterSpacing:'0.1em', textTransform:'uppercase', flexShrink:0, marginTop:2 } }, 'Despu√©s'),
            h('div', { style:{ fontSize:13, lineHeight:1.65, color:'#1a3a28', fontStyle:'italic' } }, example.to)
          )
        )
      ),
      h('a', { href: inst.sectionEditUrl, target:'_blank', rel:'noopener noreferrer', style:{ display:'inline-block', padding:'7px 15px', background:'#0A0A0A', color:'#FAF8F5', textDecoration:'none', fontSize:11, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:'0.1em', textTransform:'uppercase' } }, 'Editar en Wikipedia ‚Üí')
    )
  );
}

function Report({ result, title, url, editUrl, generatedAt }) {
  const { summary, catHits, instances, positives, structuralNotes, stats } = result;
  const hasIssues = instances.length > 0 || structuralNotes.length > 0;

  return h('div', { className:'report-anim' },
    h('div', { style:{ background:'#0A0A0A', color:'#FAF8F5', padding:'22px 26px' } },
      h('div', { style:{ display:'flex', justifyContent:'space-between', alignItems:'flex-start', flexWrap:'wrap', gap:12 } },
        h('div', null,
          h('div', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.2em', textTransform:'uppercase', color:'#E3120B', marginBottom:7 } }, 'Auditor√≠a de Sesgo Algor√≠tmico ‚Äî Biograf√≠a Femenina'),
          h('div', { style:{ fontFamily:"'Playfair Display',serif", fontSize:'clamp(17px,3vw,24px)', fontWeight:800, lineHeight:1.2 } }, title),
          h('div', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, color:'#555', marginTop:7, letterSpacing:'0.05em' } },
            `${stats.totalWords.toLocaleString()} palabras ¬∑ ${stats.totalSentences} oraciones ¬∑ ${stats.passiveRate}% voz pasiva ¬∑ ${generatedAt}`)
        ),
        h('div', { style:{ display:'flex', gap:8, flexWrap:'wrap' }, className:'no-print' },
          h('a', { href:url, target:'_blank', rel:'noopener noreferrer', style:{ padding:'8px 14px', border:'1px solid #444', color:'#bbb', textDecoration:'none', fontSize:11, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:'0.07em' } }, 'Ver ‚Üó'),
          h('a', { href:editUrl, target:'_blank', rel:'noopener noreferrer', style:{ padding:'8px 14px', background:'#E3120B', color:'#fff', textDecoration:'none', fontSize:11, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:'0.07em', fontWeight:700 } }, '‚úè Editar en Wikipedia'),
          h('button', { onClick:()=>window.print(), style:{ padding:'8px 14px', border:'1px solid #444', background:'none', color:'#aaa', fontSize:11, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:'0.07em', cursor:'pointer' } }, '‚éô PDF')
        )
      )
    ),

    h('div', { style:{ padding:'22px 26px' } },
      h('div', { style:{ marginBottom:22 } },
        h('div', { style:{ fontFamily:"'Playfair Display',serif", fontSize:19, fontWeight:800, marginBottom:8 } }, 'Resumen'),
        h('div', { style:{ fontSize:15, lineHeight:1.8, color:'#333', fontWeight:300 } }, summary),
        h('div', { style:{ marginTop:12 } },
          Object.keys(catHits).map(k => h(CatPill, { key:k, catKey:k, count:catHits[k] }))
        )
      ),

      structuralNotes.length > 0 && h('div', { style:{ marginBottom:22 } },
        structuralNotes.map((note, i) =>
          h('div', { key:i, style:{ padding:'13px 16px', background:'#fffbe6', border:'1px solid #f5d87a', marginBottom:8, fontSize:14, lineHeight:1.75, color:'#5a4000', fontWeight:300 } },
            h('span', { style:{ fontWeight:700 } }, '‚ö† Nota estructural: '), note)
        )
      ),

      hasIssues && h('div', { style:{ marginBottom:22 } },
        h('div', { style:{ display:'flex', justifyContent:'space-between', alignItems:'baseline', marginBottom:14, flexWrap:'wrap', gap:8 } },
          h('div', { style:{ fontFamily:"'Playfair Display',serif", fontSize:19, fontWeight:800 } }, 'Pasajes marcados'),
          h('div', { className:'no-print', style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, color:'#bbb', letterSpacing:'0.07em' } }, 'Haz clic para expandir')
        ),
        instances.length > 0
          ? instances.map((inst,i) => h(InstanceCard, { key:i, inst }))
          : h('div', { style:{ color:'#888', fontSize:14 } }, 'No se detectaron pasajes problem√°ticos.')
      ),

      positives.length > 0 && h('div', { style:{ marginBottom:22 } },
        h('div', { style:{ fontFamily:"'Playfair Display',serif", fontSize:19, fontWeight:800, marginBottom:10 } }, 'Lo que este art√≠culo hace bien'),
        positives.map((p, i) =>
          h('div', { key:i, style:{ padding:'10px 14px', background:'#e9f6ee', border:'1px solid #b8dfc9', marginBottom:7, fontSize:14, lineHeight:1.7, color:'#1a3a28', fontWeight:300 } },
            h('span', { style:{ color:'#1a7a4a', fontWeight:700 } }, '‚úì '), p)
        )
      ),

      h('div', { style:{ marginBottom:22, padding:'18px 20px', background:'#f5f5f5', border:'1px solid #ddd' } },
        h('div', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.15em', textTransform:'uppercase', color:'#888', marginBottom:10, fontWeight:700 } }, 'Gu√≠a de edici√≥n'),
        [
          ['1. Examina cada pasaje marcado', 'El contexto importa: no cada patr√≥n detectado supone un sesgo real en su contexto espec√≠fico.'],
          ['2. Comprueba las fuentes', 'Si el art√≠culo describe algo que realmente ocurri√≥ (p.ej. un marido que ayud√≥), el hecho puede permanecer ‚Äî solo reformula el encuadre.'],
          ['3. Edita por secci√≥n', 'Haz clic en ¬´Editar en Wikipedia¬ª para ir directamente a la secci√≥n que contiene el problema.'],
          ['4. S√© neutral', 'Wikipedia requiere un punto de vista neutral. No a√±adas valoraciones positivas para compensar las negativas.'],
          ['5. Resume tu edici√≥n', 'Usa el resumen de edici√≥n para explicar brevemente el cambio (ej. ¬´Lenguaje m√°s neutral¬ª).'],
        ].map(([t, d], i) =>
          h('div', { key:i, style:{ marginBottom:8, fontSize:13, lineHeight:1.7, color:'#444' } },
            h('span', { style:{ fontWeight:700, fontFamily:"'IBM Plex Mono',monospace", fontSize:11, color:'#0A0A0A' } }, t + ' ‚Äî '), d)
        )
      ),

      h('div', { style:{ fontSize:12, color:'#aaa', fontFamily:"'IBM Plex Mono',monospace", lineHeight:1.8, borderTop:'1px solid #eee', paddingTop:14 } },
        `Nota sobre el algoritmo: esta herramienta aplica ${PATTERNS.length} patrones de expresiones regulares al texto del art√≠culo. Es basada en reglas, no en IA, y determinista: el mismo art√≠culo producir√° siempre los mismos resultados. Los falsos positivos son posibles; la revisi√≥n humana es siempre necesaria.`)
    )
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   APP PRINCIPAL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function App() {
  const [query,   setQuery]   = useState('');
  const [busy,    setBusy]    = useState(false);
  const [report,  setReport]  = useState(null);
  const [error,   setError]   = useState('');
  const [meta,    setMeta]    = useState(null);

  const QUICK = ['Frida Kahlo','Rigoberta Mench√∫','Simone de Beauvoir','Rosalind Franklin','Marie Curie'];

  const run = useCallback(async (title) => {
    const q = (title || query).trim();
    if (!q) return;
    setBusy(true); setError(''); setReport(null); setMeta(null);
    try {
      const wiki = await fetchWiki(q);
      const sectionMap = buildSectionMap(wiki.text, wiki.apiSections);
      const result = analyseArticle(wiki.title, wiki.text, sectionMap, wiki.editBase);
      setReport(result);
      setMeta({ title: wiki.title, url: wiki.url, editUrl: wiki.editUrl, generatedAt: new Date().toLocaleString('es-ES') });
    } catch(e) {
      setError(e.message || 'Se produjo un error inesperado.');
    } finally {
      setBusy(false);
    }
  }, [query]);

  const onSelect = useCallback(title => { setQuery(title); run(title); }, [run]);

  return h('div', { style:{ minHeight:'100vh', display:'flex', flexDirection:'column' } },

    h('div', { style:{ background:'#0A0A0A', color:'#FAF8F5', padding:'28px 26px 24px' } },
      h('div', { style:{ maxWidth:860, margin:'0 auto' } },
        h('div', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.22em', textTransform:'uppercase', color:'#E3120B', marginBottom:10, display:'flex', justifyContent:'space-between', alignItems:'center', flexWrap:'wrap', gap:8 } },
          h('span', null, 'Wikipedia ¬∑ Espa√±ol ¬∑ Versi√≥n 1.0'),
          h('a', { href:'index.html', style:{ color:'#E3120B', textDecoration:'none', border:'1px solid #E3120B33', padding:'3px 8px', fontSize:9 } }, 'üá¨üáß English version ‚Üí')
        ),
        h('h1', { style:{ fontFamily:"'Playfair Display',serif", fontSize:'clamp(22px,4vw,38px)', fontWeight:800, lineHeight:1.15, marginBottom:10 } },
          'Detector de Sesgo', h('br'), 'de G√©nero'),
        h('p', { style:{ fontSize:14, color:'#aaa', fontFamily:"'Source Serif 4',serif", fontWeight:300, lineHeight:1.7, maxWidth:560, marginBottom:22 } },
          'Analiza art√≠culos de Wikipedia sobre mujeres en busca de patrones de sesgo de g√©nero. Sin IA. Sin registro. Solo introduce un nombre.')
      )
    ),

    h('div', { style:{ background:'#F2EDE7', padding:'20px 26px', borderBottom:'1px solid #e0d8cf' }, className:'no-print' },
      h('div', { style:{ maxWidth:860, margin:'0 auto' } },
        h('div', { style:{ display:'flex', gap:10, flexWrap:'wrap', marginBottom:12, alignItems:'center' } },
          h(SearchDropdown, { value:query, onChange:setQuery, onSelect, onSubmit:()=>run() }),
          h('button', { onClick:()=>run(), disabled:busy||!query.trim(),
            style:{ padding:'13px 22px', background:'#E3120B', color:'#fff', border:'none', fontSize:13, fontFamily:"'IBM Plex Mono',monospace", letterSpacing:'0.1em', textTransform:'uppercase', cursor:'pointer', fontWeight:700, whiteSpace:'nowrap' } },
            busy ? 'Analizando‚Ä¶' : 'Analizar')
        ),
        h('div', { style:{ display:'flex', gap:8, flexWrap:'wrap', alignItems:'center', marginBottom:8 } },
          h('span', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.1em', textTransform:'uppercase', padding:'3px 9px', background:'#fff', border:'1px solid #b8dfc9', color:'#1a7a4a', fontWeight:700 } },
            'üåê es.wikipedia.org'),
        ),
        h('div', { style:{ display:'flex', gap:8, flexWrap:'wrap', alignItems:'center' } },
          h('span', { style:{ fontFamily:"'IBM Plex Mono',monospace", fontSize:9, color:'#aaa', letterSpacing:'0.1em', textTransform:'uppercase' } }, 'Ejemplos:'),
          QUICK.map(name => h('button', { key:name, onClick:()=>{ setQuery(name); run(name); },
            style:{ padding:'5px 11px', background:'#fff', border:'1px solid #C8B8A8', fontSize:12, fontFamily:"'Source Serif 4',serif", cursor:'pointer', color:'#555' } }, name))
        )
      )
    ),

    h('div', { style:{ flex:1, maxWidth:860, margin:'0 auto', width:'100%', padding:'24px 26px' } },
      error && h('div', { style:{ padding:'16px 20px', background:'#fdecea', border:'1px solid #f5c2be', color:'#8a1a26', fontSize:14, lineHeight:1.7, fontFamily:"'Source Serif 4',serif", fontWeight:300 } }, error),
      report && meta && h(Report, { result:report, title:meta.title, url:meta.url, editUrl:meta.editUrl, generatedAt:meta.generatedAt }),
      !report && !error && !busy && h('div', { style:{ textAlign:'center', padding:'60px 0', color:'#bbb' } },
        h('div', { style:{ fontFamily:"'Playfair Display',serif", fontSize:28, fontWeight:800, marginBottom:12, color:'#ddd' } }, '‚ôÄ'),
        h('div', { style:{ fontSize:15, fontFamily:"'Source Serif 4',serif", fontWeight:300, lineHeight:1.8 } },
          'Busca la biograf√≠a de una mujer para generar un an√°lisis de sesgo inmediato ‚Äî sin IA ni clave de API.'),
        h('div', { style:{ marginTop:14, fontFamily:"'IBM Plex Mono',monospace", fontSize:9, letterSpacing:'0.12em', color:'#ccc' } },
          `${PATTERNS.length} indicadores de sesgo ¬∑ 6 categor√≠as ¬∑ solo biograf√≠as de mujeres ¬∑ completamente local`)
      )
    ),

    h('div', { className:'tool-footer no-print' },
      h('span', null,
        'Creado por ',
        h('a', { href:'mailto:nethahussain@gmail.com' }, 'Netha Hussain'),
        ' ¬∑ nethahussain@gmail.com'
      ),
      h('a', { href:'https://github.com/nethahussain/wikipedia-gender-bias-detector', target:'_blank', rel:'noopener noreferrer' }, 'Ver c√≥digo en GitHub ‚Üí')
    )
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(h(App));
</script>
</body>
</html>
